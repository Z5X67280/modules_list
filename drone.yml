kind: pipeline
name: build
 
platform:
  os: linux
  arch: amd64
 
clone:
  depth: 1
 
steps:
  - name: build
    image: ubuntu:bionic
    commands:
      - bash
      - whoami
      - apt update
      - apt install -y bc megatools bison build-essential ccache curl flex g++-multilib gcc-multilib git gnupg gperf lib32ncurses5-dev lib32readline-dev lib32z1-dev liblz4-tool libncurses5-dev libsdl1.2-dev libssl-dev libwxgtk3.0-dev libxml2 libxml2-utils lzop pngcrush rsync schedtool squashfs-tools xsltproc zip zlib1g-dev repo imagemagick libbz2-dev libssl-dev lzma ncftp bash-completion openjdk-8-jdk >> slient
      - git config --global user.name "test"
      - git config --global user.email "test@test.com"
      - y | repo init -u https://github.com/Z5X67280/android -b mkp >> slient1
      - repo sync -j128 -c -f --no-clone-bundle --no-tags >> slient2
      - . build/envsetup.sh
      - brunch vince
      - export ROM=$(find out/target/product/vince -iname 'MK90.0*.zip')
      - megaput $ROM -u Z5X67280@163.com -p keternal
